(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0a3328"],{"00c5":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"select-product-for-divide-tender-wrapper"},[a("a-row",{attrs:{type:"flex"}},[a("a-col",{staticClass:"dt-left-wrapper",attrs:{flex:1}},[a("a-card",[a("Heading",{attrs:{name:"项目目录"}}),e.treeData.length?a("a-tree",{attrs:{"show-line":"",defaultExpandAll:"","tree-data":e.treeData,defaultExpandedKeys:e.defaultExpandedKeys,defaultSelectedKeys:e.selectedKeys},on:{select:e.onSelect}}):e._e()],1)],1),a("a-col",{attrs:{flex:4}},[a("div",[a("SearchForm",{attrs:{searchList:e.searchList,name:"查询条件"},on:{"on-filter":e.toSearch}}),a("a-card",{staticClass:"table-wrapper"},[a("a-table",{attrs:{size:"small",rowKey:"businessKey",loading:e.pageData.loading,pagination:!1,columns:e.columns,dataSource:e.dataSource,scroll:{x:!0},rowSelection:{fixed:!0,selectedRowKeys:e.selectedRowKeys,onChange:e.onSelectChange}},scopedSlots:e._u([{key:"projectCode",fn:function(t){return a("a",{},[e._v(e._s(t))])}}])}),a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.pageData.total>0,expression:"pageData.total > 0"}],attrs:{value:e.pageData.page,pageSize:e.pageData.limit,total:e.pageData.total},on:{change:e.sizeChange,showSizeChange:e.pageChange}})],1)],1)])],1)],1)},s=[],r=(a("4de4"),a("4160"),a("a9e3"),a("159b"),a("5530")),i=a("5880"),o=a("5acc"),d=a("8ab7"),c=a("325f"),l=a("35a4"),u={limit:15,total:0,page:1,loading:!1},p=[{title:"序号",dataIndex:"number",align:"center",customRender:function(e,t,a){return"".concat((u.page-1)*u.limit+a+1)},width:60},{title:"产品编码",dataIndex:"productCode",align:"center"},{title:"产品名称",dataIndex:"productName"},{title:"产品单位",dataIndex:"measure",align:"center"},{title:"总数量",dataIndex:"totalAmount",align:"center"}],h=[],g=[{type:"input",label:"产品名称",key:"productName"},{type:"input",label:"产品编码",key:"productCode"}],f={name:"select-product-for-divide-tender",components:{SearchForm:o["a"],Pagination:c["default"],Heading:d["default"]},props:{param:{type:Object,default:function(){return{}}}},data:function(){return{treeData:[],selectedKeys:[],subtenderId:"",defaultExpandedKeys:[],columns:p,dataSource:h,searchList:g,selectedRowKeys:[],selectedRows:[],filter:{},pageData:{limit:15,total:0,page:1,loading:!1}}},computed:Object(r["a"])({},Object(i["mapGetters"])("account",["dictionary"])),watch:{treeData:{handler:function(e){return e},immediate:!0,deep:!0}},created:function(){this.init()},methods:{init:function(){this.findIds(),this.findTree()},findTree:function(){var e=this,t={projectId:this.param.projectId};Object(l["gb"])(t).then((function(t){var a=t.data||{},n=a.responseResult||{};"0000"==a.errCode?(e.treeData=[n],e.treeData.forEach((function(t){t.children.length>0&&!t.selectable&&t.children.forEach((function(t){e.recursive(t)}))}))):e.$error({title:"错误提示",content:e.BASE.handleErrorMsg(a)})}))},recursive:function(e){var t=this;e.selectable?this.defaultExpandedKeys.length>0||(this.defaultExpandedKeys=["".concat(e.key)],this.selectedKeys=["".concat(e.key)],this.getData()):e.children.forEach((function(e){t.recursive(e)}))},findIds:function(){var e=this,t={projectId:this.param.projectId};Object(l["hb"])(t).then((function(t){var a=t.data;if("0000"==a.errCode){var n=a.responseResult;e.selectedRowKeys=n}else e.$error({title:"错误提示",content:e.BASE.handleErrorMsg(a)})}))},getData:function(){var e=this;this.subtenderId=0!=this.selectedKeys.length?this.selectedKeys[0]:"";var t=Object.assign({limit:this.pageData.limit,page:this.pageData.page,subtenderId:this.subtenderId,projectId:this.param.projectId},this.filter);this.pageData.loading=!0,Object(l["eb"])(t).then((function(t){var a=t.data,n=t.data.responseResult;if("0000"==a.errCode){var s=n.data,r=n.total;e.dataSource=s,0!=e.dataSource.length&&e.dataSource.forEach((function(t){t.projectId=e.param.projectId,t.subtenderId=e.subtenderId})),e.pageData.total=Number(r)}else e.$error({title:"错误提示",content:e.BASE.handleErrorMsg(a)});e.pageData.loading=!1}))},toSearch:function(e){this.pageData.page=1,this.filter=e,this.getData()},onSelectChange:function(e,t){this.selectedRowKeys=e,this.selectedRows=t},sizeChange:function(e,t){this.pageData.page=e,this.pageData.limit=t,this.getData()},pageChange:function(e,t){this.pageData.page=e,this.pageData.limit=t,this.getData()},onSelect:function(e){this.selectedKeys=e,this.pageData.page=1,this.getData()},getRes:function(){var e={subtenderId:this.subtenderId,selectedRowKeys:this.selectedRowKeys,selectedRows:this.selectedRows};return e}}},m=f,b=a("2877"),y=Object(b["a"])(m,n,s,!1,null,null,null);t["default"]=y.exports}}]);