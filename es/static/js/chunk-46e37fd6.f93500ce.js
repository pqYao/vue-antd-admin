(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-46e37fd6","chunk-645cdc36","chunk-1ba20d2e"],{"1ae5":function(e,t,a){"use strict";var n=a("9e89"),i=a.n(n);i.a},"3eb5":function(e,t,a){"use strict";var n=a("adf3"),i=a.n(n);i.a},"4c2b":function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-row",{attrs:{type:"flex"}},[a("a-col",{attrs:{flex:1}},[a("a-card",[a("Heading",{attrs:{name:"采购目录"}}),a("a-tree",{attrs:{"show-line":"","tree-data":this.treeData},on:{select:e.onSelect}})],1)],1),a("a-col",{attrs:{flex:4}},[a("div",[a("SearchForm",{ref:"SearchForm",attrs:{searchList:e.searchList,name:"查询条件"},on:{"on-filter":e.toSearch}}),a("a-card",[a("a-table",{attrs:{size:"small",loading:e.pageData.loading,pagination:!1,columns:e.columns,dataSource:e.dataSource,rowSelection:{fixed:!0,selectedRowKeys:e.selectedRowKeys,onChange:e.onSelectChange},scroll:{x:!0},rowKey:"productId"},scopedSlots:e._u([{key:"projectCode",fn:function(t){return a("a",{},[e._v(e._s(t))])}}])}),a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.pageData.total>0,expression:"pageData.total > 0"}],attrs:{value:e.pageData.page,pageSize:e.pageData.limit,total:e.pageData.total},on:{change:e.sizeChange,showSizeChange:e.pageChange}})],1)],1)])],1)},i=[],r=(a("4de4"),a("a9e3"),a("5530")),s=a("5880"),o=a("5acc"),l=a("8ab7"),c=a("325f"),d=a("7f97"),u=a("35a4"),h={limit:10,total:0,page:1,loading:!1},p=[{title:"序号",dataIndex:"number",align:"center",customRender:function(e,t,a){return"".concat((h.page-1)*h.limit+a+1)},width:60},{title:"产品编码",dataIndex:"productCode"},{title:"产品名称",dataIndex:"productName"},{title:"产品单位",dataIndex:"productUnit"},{title:"产品分类",dataIndex:"productLevelFullName"}],f=[],m=[{type:"input",label:"产品名称",key:"productName"},{type:"input",label:"产品编码",key:"productCode"}],g={name:"List",components:{SearchForm:o["a"],Pagination:c["default"],Heading:l["default"]},props:{projectId:{type:String,default:""}},data:function(){return{treeData:[],selectedKeys:[],columns:p,dataSource:f,searchList:m,selectedRowKeys:[],selectedRows:[],filter:{},pageData:{limit:15,total:0,page:1,loading:!1}}},computed:Object(r["a"])({},Object(s["mapGetters"])("account",["dictionary"])),watch:{treeData:{handler:function(e){return e},immediate:!0,deep:!0}},created:function(){this.pageData.limit=15,this.pageData.page=1,this.init()},methods:{init:function(){this.getData(),this.findTree(),this.findIds()},toSearch:function(e){this.filter=e,this.getData()},findTree:function(){var e=this;Object(d["a"])().then((function(t){var a=t.data;if("0000"==a.errCode){var n=a.responseResult;e.treeData=n}else e.$error({title:"错误提示",content:e.BASE.handleErrorMsg(a)})}))},findIds:function(){var e=this;Object(u["z"])(this.projectId).then((function(t){var a=t.data;if("0000"==a.errCode){var n=a.responseResult;e.selectedRowKeys=n}else e.$error({title:"错误提示",content:e.BASE.handleErrorMsg(a)})}))},onSelect:function(e){this.$refs.SearchForm.handleReset(),this.filter={},this.selectedKeys=e,this.pageData.page=1,this.getData()},getData:function(){var e=this,t=Object.assign({limit:this.pageData.limit,page:this.pageData.page,productLevel:this.selectedKeys[0]||"",projectId:this.projectId||""},this.filter);this.pageData.loading=!0,Object(d["f"])(t).then((function(t){var a=t.data,n=t.data.responseResult;if("0000"==a.errCode){var i=n.data,r=n.total;e.dataSource=i,e.pageData.total=Number(r)}else e.$error({title:"错误提示",content:e.BASE.handleErrorMsg(a)});e.pageData.loading=!1}))},onSelectChange:function(e,t){this.selectedRowKeys=e,this.selectedRows=t},sizeChange:function(e,t){this.pageData.page=e,this.pageData.limit=t,this.getData()},pageChange:function(e,t){this.pageData.page=e,this.pageData.limit=t,this.getData()},getRes:function(){return this.selectedRowKeys}}},b=g,v=a("2877"),w=Object(v["a"])(b,n,i,!1,null,null,null);t["a"]=w.exports},"57e4":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-descriptions",{attrs:{bordered:"",size:"small",column:{md:3,sm:2,xs:1}}},[a("a-descriptions-item",{attrs:{label:"Product"}},[e._v(" Cloud Database ")]),a("a-descriptions-item",{attrs:{label:"Billing Mode"}},[e._v(" Prepaid ")]),a("a-descriptions-item",{attrs:{label:"Order time"}},[e._v(" 2018-04-24 18:00:00 ")]),e._l(e.formList,(function(t,n){return a("a-descriptions-item",{directives:[{name:"show",rawName:"v-show",value:t.show,expression:"item.show"}],key:n,attrs:{label:t.label,span:t.span}},[t.flag?[e._v(" "+e._s("1"===e.param[t.key]?"是":"否")+" ")]:t.dic?[e._v(" "+e._s(e.dictionary[t.key][e.param[t.key]])+" ")]:t.pt?[e._v(" "+e._s(e.dictionary[t.key][e.param["purchaseType"]])+" ")]:t.jump?[a("a",{on:{click:function(a){return e.fnJumpPage(t.key,e.jumpData)}}},[e._v(e._s(e.param[t.key]))])]:t.tinymce?[a("div",{domProps:{innerHTML:e._s(e.param[t.key])}})]:[e._v(" "+e._s(e.param[t.key])+" ")]],2)}))],2)},i=[],r=(a("4de4"),a("5530")),s=a("5880"),o={name:"descriptions",props:{list:{type:Array,required:!0,default:function(){return[]}},param:{type:Object,required:!0,default:function(){}},jumpData:{type:Object,required:!1,default:function(){}}},watch:{list:{handler:function(e){return e},immediate:!0,deep:!0},param:{handler:function(e){return e},immediate:!0,deep:!0}},computed:Object(r["a"])(Object(r["a"])({},Object(s["mapGetters"])("account",["dictionary"])),{},{formList:function(){return this.list.filter((function(e){return!0===e.show}))}}),methods:{fnJumpPage:function(e,t){this.$router.push({path:t[e].url})}}},l=o,c=(a("1ae5"),a("2877")),d=Object(c["a"])(l,n,i,!1,null,"3ffeedfd",null);t["default"]=d.exports},5913:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{ref:"wrapper",staticClass:"anchor-demo-custom",on:{mouseover:e.mouseOver,mouseleave:e.mouseLeave}},[e.isShow?a("div",{staticClass:"anchor-btn"},[a("a-icon",{attrs:{type:"right"}}),a("a-icon",{staticStyle:{"margin-left":"-4px"},attrs:{type:"right"}})],1):a("div",{staticClass:"anchor-btn"},[a("a-icon",{attrs:{type:"left"}}),a("a-icon",{staticStyle:{"margin-left":"-4px"},attrs:{type:"left"}})],1),a("a-anchor",{directives:[{name:"show",rawName:"v-show",value:e.isShow,expression:"isShow"}],ref:"demo",attrs:{targetOffset:200},on:{click:e.handleClickFun,change:e.onChange}},[e._l(e.anchorList,(function(t,n){return a("span",{key:n},[a("a-anchor-link",{ref:"span",refInFor:!0,attrs:{href:"#"+t}},[a("template",{slot:"title"},[a("i",{class:["iconfont","icon-yuanxing"]}),e._v(" "+e._s(t)+" ")])],2)],1)})),a("div")],2)],1)},i=[],r={props:{anchorList:{type:Array,required:!1}},data:function(){return{isShow:!1}},methods:{handleClickFun:function(e,t){if(e.preventDefault(),t.href){var a=document.getElementById(t.href);a&&a.scrollIntoView({block:"start",behavior:"smooth"})}},mouseOver:function(){var e=this;this.$refs.wrapper.style.marginTop=-(33*this.anchorList.length+40)/2+"px",this.$nextTick((function(){e.isShow=!0}))},mouseLeave:function(){this.isShow=!1},onChange:function(){}}},s=r,o=(a("3eb5"),a("2877")),l=Object(o["a"])(s,n,i,!1,null,"22bac0c2",null);t["default"]=l.exports},"9e89":function(e,t,a){},adf3:function(e,t,a){},df77:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("a-card",[e.isDetail?a("Heading",{attrs:{name:"产品明细"}}):a("Heading",{attrs:{name:"产品明细"}},[e.show?[a("a-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleAdd("product")}}},[e._v("关联产品")]),a("a-popconfirm",{attrs:{disabled:!this.hasSelectedRowKeys,title:"确定批量删除?","ok-text":"确认","cancel-text":"取消"},on:{confirm:e.handleDelete}},[a("a-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleDelete(0)}}},[a("i",{class:["iconfont","icon-weibiaoti544"]}),e._v(" 批量删除 ")])],1),a("a-button",{attrs:{type:"primary",disabled:e.isConnect},on:{click:e.handleSubmit}},[a("i",{class:["iconfont","icon-baocun"]}),e._v(" 保存 ")])]:e._e()],2),e.show?a("a-table",{staticClass:"es-table",attrs:{size:"small",bordered:!0,loading:e.pageData.loading,pagination:!1,columns:e.columns,dataSource:e.dataSource,rowKey:"projectDetailId",rowSelection:e.isDetail?null:{fixed:!0,selectedRowKeys:e.selectedRowKeys,onChange:e.onSelectChange},scroll:{x:!0}},scopedSlots:e._u([{key:"requirementAmout",fn:function(t,n,i){return[e.isDetail?a("span",[e._v(e._s(t))]):a("a-form",{attrs:{form:e.form},on:{submit:e.handleSubmit}},[a("a-form-item",[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["requirementAmout"+i,{validateTrigger:["blur"],rules:[{required:!0,validator:e.checkAmount}],initialValue:t}],expression:"[\n                `requirementAmout${index}`,\n                {\n                  validateTrigger: ['blur'],\n                  rules: [{ required: true, validator: checkAmount }],\n                  initialValue: text\n                }\n              ]"}],staticStyle:{margin:"-5px 0",width:"100%"},attrs:{allowClear:""},on:{change:function(t){return e.onCellChange(t.target.value,n.projectDetailId,"requirementAmout")}}})],1)],1)]}},{key:"action",fn:function(t){return[a("a-popconfirm",{attrs:{title:"是否确认删除所选行?","ok-text":"确认","cancel-text":"取消"},on:{confirm:function(a){return e.deleteById(t.projectDetailId)}}},[a("a",{staticStyle:{"margin-right":"8px"}},[e._v("删除")])])]}}],null,!1,162820780)}):e._e(),e.show&&this.isDetail?a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.pageData.total>0,expression:"pageData.total > 0"}],attrs:{value:e.pageData.page,pageSize:e.pageData.limit,total:e.pageData.total},on:{change:e.sizeChange,showSizeChange:e.pageChange}}):e._e()],1),e.productVisible?a("a-modal",{attrs:{title:"选择产品",width:"80%",centered:!0,maskClosable:!1},on:{ok:function(t){return e.handleOk("product")}},model:{value:e.productVisible,callback:function(t){e.productVisible=t},expression:"productVisible"}},[a("ProductSelect",{ref:"product",attrs:{projectId:e.baseData.projectId}})],1):e._e()],1)},i=[],r=(a("4de4"),a("a15b"),a("a9e3"),a("2909")),s=a("8ab7"),o=a("7775"),l=a("325f"),c=a("4c2b"),d={limit:15,total:0,page:1,loading:!1},u=[{title:"序号",dataIndex:"number",align:"center",width:80,customRender:function(e,t,a){return"".concat((d.page-1)*d.limit+a+1)}},{title:"产品编码",dataIndex:"productCode",align:"center"},{title:"产品名称",dataIndex:"productName"},{title:"单位",dataIndex:"productUnit",align:"center"},{title:"需求数量",dataIndex:"requirementAmout",scopedSlots:{customRender:"requirementAmout"},align:"center"},{title:"操作",align:"center",scopedSlots:{customRender:"action"},fixed:"right",width:80}],h=[],p={name:"QueryList",components:{Heading:s["default"],Pagination:l["default"],ProductSelect:c["a"]},props:{isDetail:{type:Boolean,default:!1},baseData:{type:Object}},data:function(){return{form:this.$form.createForm(this),columns:u,dataSource:h,selectedRowKeys:[],selectedRows:[],show:!1,isConnect:!1,productVisible:!1,pageData:d}},computed:{hasSelectedRowKeys:function(){return 0!=!!this.selectedRowKeys.length}},watch:{baseData:{handler:function(e){return this.show=!this.BASE.ObjectIsNull(this.baseData),this.show&&this.getData(),e},immediate:!0,deep:!0},isDetail:{handler:function(e){if(e){var t=Object(r["a"])(this.columns);delete t[5],this.columns=t}return e},immediate:!0,deep:!0}},activated:function(){this.isDetail&&this.getData()},methods:{getData:function(){var e=this,t=Object.assign({limit:this.isDetail?this.pageData.limit:1e4,page:this.pageData.page,projectId:this.baseData.projectId},this.filter);this.dataSource=[],this.pageData.loading=!0,Object(o["s"])(t).then((function(t){var a=t.data,n=t.data.responseResult;if("0000"==a.errCode){var i=n.data,r=n.total;e.dataSource=i,e.pageData.total=Number(r)}else e.$error({title:"错误提示",content:e.BASE.handleErrorMsg(a)});e.pageData.loading=!1}))},handleAdd:function(e){this["".concat(e,"Visible")]=!0},handleOk:function(e){var t=this,a=this.$refs[e].getRes();Object(o["a"])(a.join(","),this.baseData.projectId).then((function(e){var a=e.data;if("0000"===a.errCode){var n=a.responseResult;t.$message.success(n,3),t.getData()}else t.$error({title:"错误提示",content:t.BASE.handleErrorMsg(a)})})),this["".concat(e,"Visible")]=!1},checkAmount:function(e,t,a){if(this.BASE.CheckIsNullOrEmpty(t)){var n=this.BASE.reg.mountReg;n.test(t)||a("请输入0.01-999999999999.99的数值！"),a()}else a("请输入需求数量")},onCellChange:function(e,t,a){var n=Object(r["a"])(this.dataSource),i=n.filter((function(e){return t===e.projectDetailId}))[0];i&&(i[a]=e,this.dataSource=n)},handleSubmit:function(e){var t=this;e.preventDefault(e),this.form.validateFieldsAndScroll(this.BASE.formScrollOptions,(function(e){e||(t.isConnect=!0,t.updateInfo())}))},updateInfo:function(){var e=this;Object(o["U"])(this.dataSource).then((function(t){var a=t.data;"0000"===a.errCode?(e.$message.success(a.responseResult,3),e.getData()):e.$error({title:"错误提示",content:e.BASE.handleErrorMsg(a)}),e.isConnect=!1}))},onSelectChange:function(e,t){this.selectedRowKeys=e,this.selectedRows=t},handleDelete:function(e){if(!this.hasSelectedRowKeys)return this.$message.warning("请选择要删除的数据！"),!1;0!=e&&this.deleteById()},deleteById:function(e){var t=this,a=e||this.selectedRowKeys.join(",");Object(o["l"])(a).then((function(e){var a=e.data;if("0000"===a.errCode){var n=a.responseResult;t.$message.warning(n),t.selectedRowKeys=[],t.getData()}}))},sizeChange:function(e,t){this.pageData.page=e,this.pageData.limit=t,this.getData()},pageChange:function(e,t){this.pageData.page=e,this.pageData.limit=t,this.getData()}}},f=p,m=a("2877"),g=Object(m["a"])(f,n,i,!1,null,null,null);t["a"]=g.exports},f19d:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("span",{attrs:{id:"基本信息"}}),a("BaseView",{on:{"send-data":e.getData}}),a("span",{attrs:{id:"产品明细"}}),a("Product",{attrs:{baseData:e.baseData,isDetail:!0}}),a("Anchor",{attrs:{anchorList:e.anchorList}})],1)},i=[],r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("a-card",[a("Heading",{attrs:{name:"详情信息"}}),a("Descriptions",{attrs:{list:e.baseList,param:e.formData}})],1),a("a-card",[a("Heading",{attrs:{name:"项目情况说明",id:"项目情况说明"}}),a("Descriptions",{attrs:{list:e.explainlist,param:e.explainData}})],1)],1)},s=[],o=a("8ab7"),l=a("57e4"),c=a("7775"),d={components:{Heading:o["default"],Descriptions:l["default"]},data:function(){return{formData:{},explainData:{},baseList:[{label:"采购项目编号",key:"projectCode",show:!0},{label:"项目所属年份",key:"projectYear",show:!0},{label:"采购方式",key:"comparatePurchaseType",pt:!0,show:!0},{label:"采购项目名称",key:"projectName",span:"3",show:!0},{label:"物资类型",key:"materialType",dic:!0,show:!0},{label:"需求单位/部门",key:"requirementName",show:!0},{label:"开支类型",key:"expenditureType",dic:!0,show:!0},{label:"估算金额(不含税/元)",key:"predictTaxFree",show:!0},{label:"估算金额(含税/元)",key:"predictTax",show:!0},{label:"是否资格预审",key:"prequalficationFlag",flag:!0,show:!1},{label:"是否委托",key:"entrustFlag",flag:!0,show:!0},{label:"代理机构名称",key:"agencyOrgName",show:!1},{label:"代理机构项目经理",key:"agencyOrgManegerName",show:!1},{label:"采购回避事项说明",key:"projectAvoid",dic:!0,span:"5",show:!0},{label:"创建部门",key:"createUnitName",show:!0},{label:"创建时间",key:"createDate",show:!0},{label:"项目经理",key:"createName",show:!0}],explainlist:[{label:"邀请采购理由",key:"projectInvite",show:!1,span:3},{label:"申报情况说明",key:"projectDeclare",show:!0,span:3},{label:"项目描述",key:"projectDescribe",show:!0,span:3},{label:"采购项目依据",key:"projectBasis",show:!0,span:3}]}},created:function(){this.findProjectInfo(),this.findInfo()},methods:{findProjectInfo:function(){var e=this;Object(c["u"])(this.$route.params.id).then((function(t){var a=t.data;if("0000"==a.errCode){var n=a.responseResult;e.formData=n,e.$emit("send-data",e.formData),e.initList(e.formData)}else e.$error({title:"错误提示",content:e.BASE.handleErrorMsg(a)})}))},findInfo:function(){var e=this;Object(c["t"])(this.$route.params.id).then((function(t){var a=t.data;if("0000"==a.errCode){var n=a.responseResult;e.explainData=n}else e.$error({title:"错误提示",content:e.BASE.handleErrorMsg(a)})}))},initList:function(e){"4"===e.purchaseType&&(this.explainlist[0].show=!0),"3"===e.purchaseType&&(this.baseList[9].show=!0),"1"===e.entrustFlag&&(this.baseList[11].show=!0,this.baseList[12].show=!0)}}},u=d,h=a("2877"),p=Object(h["a"])(u,r,s,!1,null,null,null),f=p.exports,m=a("df77"),g=a("5913"),b={components:{BaseView:f,Anchor:g["default"],Product:m["a"]},data:function(){return{anchorList:["基本信息","附件管理","项目情况说明","产品明细"],baseData:{}}},watch:{baseData:{handler:function(e){return e},immediate:!0,deep:!0}},methods:{getData:function(e){this.baseData=e}}},v=b,w=Object(h["a"])(v,n,i,!1,null,null,null);t["default"]=w.exports}}]);