(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-da3bf500"],{"815d":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("a-card",[a("Heading",{attrs:{name:"邀请供应商"}},[1==this.pageType?[a("a-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleAdd("supplier")}}},[e._v("选择供应商")]),a("a-popconfirm",{attrs:{disabled:!this.hasSelectedRowKeys,title:"确定批量删除?","ok-text":"确认","cancel-text":"取消"},on:{confirm:e.handleDelete}},[a("a-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleDelete(0)}}},[a("i",{class:["iconfont","icon-weibiaoti544"]}),e._v(" 批量删除 ")])],1)]:e._e()],2),a("a-table",{staticClass:"es-table",attrs:{size:"small",bordered:!0,loading:e.pageData.loading,pagination:!1,columns:e.columns,dataSource:e.dataSource,rowKey:"tenderVendorId",scroll:{x:!0},rowSelection:0==this.pageType?null:{fixed:!0,selectedRowKeys:e.selectedRowKeys,onChange:e.onSelectChange}},scopedSlots:e._u([{key:"action",fn:function(t){return[a("a-popconfirm",{attrs:{title:"是否确认删除所选行?","ok-text":"确认","cancel-text":"取消"},on:{confirm:function(a){return e.deleteById(t.tenderVendorId)}}},[a("a",{staticStyle:{"margin-right":"8px"}},[e._v("删除")])])]}}])}),0==this.pageType?a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.pageData.total>0,expression:"pageData.total > 0"}],attrs:{value:e.pageData.page,pageSize:e.pageData.limit,total:e.pageData.total},on:{change:e.sizeChange,showSizeChange:e.pageChange}}):e._e()],1),e.supplierVisible?a("a-modal",{attrs:{title:"选择供应商",width:"80%",centered:!0,maskClosable:!1},on:{ok:function(t){return e.handleOk("supplier")}},model:{value:e.supplierVisible,callback:function(t){e.supplierVisible=t},expression:"supplierVisible"}},[a("SupplierSelect",{ref:"supplier"})],1):e._e()],1)},i=[],r=(a("4de4"),a("a15b"),a("a434"),a("a9e3"),a("2909")),s=a("8ab7"),o=a("325f"),c=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-row",{attrs:{type:"flex"}},[a("a-col",{attrs:{flex:1}},[a("a-card",[a("Heading",{attrs:{name:"层级"}}),e.treeData.length>0?a("a-tree",{attrs:{"show-line":"",defaultExpandedKeys:e.defaultExpandedKeys,defaultSelectedKeys:e.selectedKeys,"tree-data":this.treeData},on:{select:e.onSelect}}):e._e()],1)],1),a("a-col",{attrs:{flex:4}},[a("div",[a("SearchForm",{ref:"SearchForm",attrs:{searchList:e.searchList,name:"查询条件"},on:{"on-filter":e.toSearch}}),a("a-card",[a("a-table",{staticClass:"es-table",attrs:{size:"small",loading:e.pageData.loading,pagination:!1,columns:e.columns,dataSource:e.dataSource,rowSelection:{fixed:!0,selectedRowKeys:e.selectedRowKeys,onChange:e.onSelectChange},scroll:{x:!0},rowKey:"businessKey"},scopedSlots:e._u([{key:"orgType",fn:function(t){return[e._v(" "+e._s(e.dictionary.orgType?e.dictionary.orgType[t]:"--")+" ")]}}])}),a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.pageData.total>0,expression:"pageData.total > 0"}],attrs:{value:e.pageData.page,pageSize:e.pageData.limit,total:e.pageData.total},on:{change:e.sizeChange,showSizeChange:e.pageChange}})],1)],1)])],1)},l=[],d=(a("4160"),a("159b"),a("5530")),u=a("5880"),h=a("5acc"),p=a("bb10"),g=a("5cb8"),f={limit:10,total:0,page:1,loading:!1},m=[{title:"序号",dataIndex:"number",align:"center",customRender:function(e,t,a){return"".concat((f.page-1)*f.limit+a+1)},width:100},{title:"供应商名称",dataIndex:"vendorName",align:"center"},{title:"供应商编码",dataIndex:"vendorCode",align:"center"},{title:"组织机构类型",scopedSlots:{customRender:"orgType"},dataIndex:"orgType",align:"center"},{title:"统一社会信用代码",dataIndex:"creditCode",align:"center"}],y=[{type:"input",label:"供应商名称",key:"vendorName"},{type:"input",label:"供应商编码",key:"vendorCode"},{type:"select",label:"组织机构类型",key:"orgType"}],b={name:"supplier-select",components:{SearchForm:h["a"],Pagination:o["default"],Heading:s["default"]},data:function(){return{treeData:[],selectedKeys:[],columns:m,dataSource:[],searchList:y,defaultExpandedKeys:[],selectedRowKeys:[],selectedRows:[],filter:{},pageData:{limit:15,total:0,page:1,loading:!1}}},computed:Object(d["a"])(Object(d["a"])({},Object(u["mapGetters"])("account",["dictionary"])),{},{projectId:function(){return this.$route.query.projectId},tenderVindicateId:function(){return this.$route.params.id}}),watch:{treeData:{handler:function(e){return e},immediate:!0,deep:!0}},created:function(){this.init()},methods:{init:function(){this.handleGetData(),this.findTree(),this.findIds()},toSearch:function(e){this.pageData.page=1,this.filter=e,this.handleGetData()},findTree:function(){var e=this;Object(g["j"])({projectId:this.projectId,canSelectLevel:""}).then((function(t){var a=t.data;if("0000"==a.errCode){var n=a.responseResult;e.treeData.push(n),e.treeData.forEach((function(t){t.children.length>0&&!t.selectDefault&&t.children.forEach((function(t){e.recursive(t)}))}))}else e.$error({title:"错误提示",content:e.BASE.handleErrorMsg(a)})}))},recursive:function(e){var t=this;e.selectDefault?this.defaultExpandedKeys.length>0||(this.defaultExpandedKeys=["".concat(e.key)],this.selectedKeys=["".concat(e.key)],this.handleGetData()):e.children.forEach((function(e){t.recursive(e)}))},findIds:function(){var e=this;Object(g["w"])(this.tenderVindicateId).then((function(t){var a=t.data;if("0000"==a.errCode){var n=a.responseResult;e.selectedRowKeys=n}else e.$error({title:"错误提示",content:e.BASE.handleErrorMsg(a)})}))},onSelect:function(e){this.$refs.SearchForm.handleReset(),this.filter={},this.selectedKeys=e,this.pageData.page=1,this.handleGetData()},handleGetData:function(){var e=this,t=Object.assign({limit:this.pageData.limit,page:this.pageData.page,subcontractingId:this.selectedKeys[0]||""},this.filter);this.pageData.loading=!0,Object(p["c"])(t).then((function(t){var a=t.data,n=t.data.responseResult;if("0000"==a.errCode){var i=n.data,r=n.total;e.dataSource=i,e.pageData.total=Number(r)}else e.$error({title:"错误提示",content:e.BASE.handleErrorMsg(a)});e.pageData.loading=!1}))},onSelectChange:function(e,t){this.selectedRowKeys=e,this.selectedRows=t},sizeChange:function(e,t){this.pageData.page=e,this.pageData.limit=t,this.handleGetData()},pageChange:function(e,t){this.pageData.page=e,this.pageData.limit=t,this.handleGetData()},getRes:function(){return this.selectedRowKeys}}},w=b,D=a("2877"),v=Object(D["a"])(w,c,l,!1,null,null,null),S=v.exports,I={limit:15,total:0,page:1,loading:!1},R=[{title:"序号",dataIndex:"number",align:"center",width:80,customRender:function(e,t,a){return"".concat((I.page-1)*I.limit+a+1)}},{title:"项目名称",dataIndex:"projectName"},{title:"项目编码",dataIndex:"projectCode",align:"center"},{title:"标",dataIndex:"subtenderName",align:"center"},{title:"包",dataIndex:"subcontractingName",align:"center"},{title:"供应商名称",dataIndex:"vendorName",align:"center"},{title:"供应商编码",dataIndex:"vendorCode",align:"center"},{title:"统一社会信用代码",dataIndex:"creditCode",align:"center"},{title:"操作",align:"center",scopedSlots:{customRender:"action"},fixed:"right"}],x={name:"tender-supplier",components:{Heading:s["default"],Pagination:o["default"],SupplierSelect:S},props:{pageType:{type:[Number,String],default:1}},data:function(){return{form:this.$form.createForm(this),columns:R,dataSource:[],selectedRowKeys:[],selectedRows:[],supplierVisible:!1,pageData:I}},computed:{hasSelectedRowKeys:function(){return 0!=!!this.selectedRowKeys.length},tenderVindicateId:function(){return this.$route.params.id},projectId:function(){return this.$route.query.projectId}},created:function(){this.fnInit(),this.handleGetData()},methods:{fnInit:function(){var e=Object(r["a"])(this.columns),t=this.columns.length-1;0==this.pageType&&e.splice(t,1),this.columns=Object(r["a"])(e)},handleGetData:function(){var e=this,t=Object.assign({limit:0==this.pageType?this.pageData.limit:1e4,page:this.pageData.page,tenderVindicateId:this.tenderVindicateId},this.filter);this.pageData.loading=!0,this.dataSource=[],this.selectedRowKeys=[],this.selectedRows=[],Object(g["B"])(t).then((function(t){var a=t.data||{},n=a.responseResult||{};if("0000"==a.errCode){var i=n.data,r=n.total;e.dataSource=i,e.pageData.total=Number(r)}else e.$error({title:"错误提示",content:e.BASE.handleErrorMsg(a)});e.pageData.loading=!1}))},handleAdd:function(e){this["".concat(e,"Visible")]=!0},handleOk:function(e){var t=this,a=this.$refs[e].getRes();Object(g["N"])(a.join(","),this.projectId,this.tenderVindicateId).then((function(e){var a=e.data;if("0000"===a.errCode){var n=a.responseResult;t.$message.success(n,3),t.handleGetData()}else t.$error({title:"错误提示",content:t.BASE.handleErrorMsg(a)})})),this["".concat(e,"Visible")]=!1},handleSubmit:function(e){var t=this;e.preventDefault(e),this.form.validateFieldsAndScroll(this.BASE.formScrollOptions,(function(e){e||(t.isConnect=!0,t.updateInfo())}))},updateInfo:function(){var e=this;Object(g["U"])(this.dataSource).then((function(t){var a=t.data;"0000"===a.errCode?(e.handleGetData(),e.$message.success(a.responseResult,3)):e.$error({title:"错误提示",content:e.BASE.handleErrorMsg(a)}),e.isConnect=!1}))},onSelectChange:function(e,t){this.selectedRowKeys=e,this.selectedRows=t},handleDelete:function(e){if(!this.hasSelectedRowKeys)return this.$message.warning("请选择要删除的数据！"),!1;0!=e&&this.deleteById()},deleteById:function(e){var t=this,a=e||this.selectedRowKeys.join(",");Object(g["n"])(a).then((function(e){var a=e.data;if("0000"===a.errCode){var n=a.responseResult;t.$message.warning(n),t.selectedRowKeys=[],t.handleGetData()}}))},sizeChange:function(e,t){this.pageData.page=e,this.pageData.limit=t,this.handleGetData()},pageChange:function(e,t){this.pageData.page=e,this.pageData.limit=t,this.handleGetData()}}},j=x,C=Object(D["a"])(j,n,i,!1,null,null,null);t["default"]=C.exports},bb10:function(e,t,a){"use strict";a.d(t,"a",(function(){return s})),a.d(t,"b",(function(){return c})),a.d(t,"d",(function(){return d})),a.d(t,"c",(function(){return h}));a("96cf");var n=a("1da1"),i=a("7424"),r=a("b775");function s(e){return o.apply(this,arguments)}function o(){return o=Object(n["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(r["e"])("".concat(i["userinfo"],"/agencyInfo/findAgencyInfoByPage"),r["a"].GET,t));case 1:case"end":return e.stop()}}),e)}))),o.apply(this,arguments)}function c(e){return l.apply(this,arguments)}function l(){return l=Object(n["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(r["e"])("".concat(i["userinfo"],"/userInfo/findUserInfoByPage"),r["a"].GET,t));case 1:case"end":return e.stop()}}),e)}))),l.apply(this,arguments)}function d(e){return u.apply(this,arguments)}function u(){return u=Object(n["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(r["e"])("".concat(i["userinfo"],"/vendorUserInfo/findVendorUserInfoByPage"),r["a"].GET,t));case 1:case"end":return e.stop()}}),e)}))),u.apply(this,arguments)}function h(e){return p.apply(this,arguments)}function p(){return p=Object(n["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(r["e"])("".concat(i["userinfo"],"/agencyInfo/findVendorInfoByPage"),r["a"].GET,t));case 1:case"end":return e.stop()}}),e)}))),p.apply(this,arguments)}}}]);