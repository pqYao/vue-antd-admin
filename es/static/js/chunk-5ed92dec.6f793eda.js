(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5ed92dec","chunk-e2119ce0","chunk-03edaf33"],{"20ee":function(e,t,a){e.exports=a.p+"static/img/ic_tt.6b8ea247.png"},"325f":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-pagination",{staticClass:"my-pagination",attrs:{total:e.total,size:e.size,showTotal:function(e,t){return"共 "+e+" 条"},hideOnSinglePage:e.hideOnSinglePage,showQuickJumper:e.showQuickJumper,showSizeChanger:e.showSizeChanger,pageSize:e.currentPageSize,pageSizeOptions:e.pageSizeOptions},on:{"update:pageSize":function(t){e.currentPageSize=t},"update:page-size":function(t){e.currentPageSize=t},change:e.change,showSizeChange:e.showSizeChange},model:{value:e.current,callback:function(t){e.current=t},expression:"current"}})},i=[],r=(a("a9e3"),{name:"my-pagination",props:{value:{type:Number},hideOnSinglePage:{type:Boolean,default:!1},pageSize:{type:Number,default:10},pageSizeOptions:{type:Array,default:function(){return["10","15","30","50","100","200"]}},showQuickJumper:{type:Boolean,default:!0},showSizeChanger:{type:Boolean,default:!0},simple:{type:Boolean,default:!1},size:{type:String,default:"small"},total:{type:Number,default:1}},data:function(){return{current:this.value,currentPageSize:this.pageSize}},watch:{value:function(e){this.current=e},pageSize:function(e){this.currentPageSize=e}},methods:{change:function(e,t){this.$emit("input",e),this.$emit("update:pageSize",t),this.$emit("change",e,t)},showSizeChange:function(e,t){this.$emit("input",e),this.$emit("update:pageSize",t),this.$emit("showSizeChange",e,t)}}}),s=r,o=(a("8432"),a("2877")),l=Object(o["a"])(s,n,i,!1,null,"599f588a",null);t["default"]=l.exports},"4b47":function(e,t,a){},"68d5":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("a-card",[a("Heading",{attrs:{name:"维护项目文件"}},[1==this.pageType?[a("a-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleUpdate("tenderFileName")}}},[e._v("维护项目文件")]),a("a-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleUpdate("offerWay")}}},[e._v("维护报价方式")]),a("a-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleUpdate("tenderMoney")}}},[e._v("标书费用")]),a("a-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleShow()}}},[e._v(e._s(e.show?"收起查询":"展开查询"))]),a("a-button",{attrs:{type:"primary",disabled:e.isConnect},on:{click:e.handleSubmit}},[a("i",{class:["iconfont","icon-baocun"]}),e._v(" 保存 ")])]:e._e()],2),e.show?a("a-card",[a("a-form",{staticClass:"es-form-small",attrs:{layout:"horizontal",form:e.searchForm},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:(t.preventDefault(),e.handleSearch(t))}}},[a("a-row",[a("a-col",{attrs:{md:8,sm:24}},[a("a-form-item",e._b({attrs:{label:"标"}},"a-form-item",e.BASE.searchItemLayout,!1),[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["subtenderId",{initialValue:e.subtenderId}],expression:"[\n                  `subtenderId`,\n                  {\n                    initialValue: subtenderId\n                  }\n                ]"}],attrs:{"label-in-value":""},on:{change:e.handleSubtenderNameChange}},e._l(e.subtenderData,(function(t,n){return a("a-select-option",{key:n,class:{"hide-select-item":!t},attrs:{value:""+t.id}},[e._v(e._s(t.name))])})),1)],1)],1),a("a-col",{attrs:{md:8,sm:24}},[a("a-form-item",e._b({attrs:{label:"包"}},"a-form-item",e.BASE.searchItemLayout,!1),[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["subcontractingId",{initialValue:e.subcontractingId}],expression:"[\n                  `subcontractingId`,\n                  {\n                    initialValue: subcontractingId\n                  }\n                ]"}],attrs:{disabled:!e.subtenderName,"label-in-value":""},on:{change:e.handleSubcontractChange}},e._l(e.subcontractData,(function(t,n){return a("a-select-option",{key:n,class:{"hide-select-item":!t},attrs:{value:""+t.id}},[e._v(e._s(t.name))])})),1)],1)],1),a("a-col",{attrs:{md:8,sm:24}},[a("span",{staticStyle:{float:"right","margin-right":"30px","margin-top":"4px"}},[a("a-space",{attrs:{size:8}},[a("a-button",{attrs:{type:"primary"},on:{click:e.handleGetData}},[e._v("查询")]),a("a-button",{on:{click:e.handleReset}},[e._v("重置")])],1)],1)])],1)],1)],1):e._e(),a("a-form",{attrs:{form:e.form},on:{submit:e.handleSubmit}},[a("a-table",{staticClass:"es-table",attrs:{size:"small",bordered:!0,loading:e.pageData.loading,pagination:!1,columns:e.columns,dataSource:e.dataSource,rowKey:"tenderFileId",scroll:{x:1300},rowSelection:0==this.pageType?null:{fixed:!0,selectedRowKeys:e.selectedRowKeys,onChange:e.onSelectChange}},scopedSlots:e._u([{key:"tenderMoney",fn:function(t,n,i){return[1==e.pageType?a("a-form-item",[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["tenderMoney"+i,{rules:[{required:!0,validator:e.validTenderMoney}],validateTrigger:["blur"],initialValue:t}],expression:"[\n                `tenderMoney${index}`,\n                {\n                  rules: [{ required: true, validator: validTenderMoney }],\n                  validateTrigger: ['blur'],\n                  initialValue: text\n                }\n              ]"}],staticStyle:{margin:"-5px 0",width:"100%"},attrs:{allowClear:""},on:{change:function(t){return e.onCellChange(t.target.value,n.tenderFileId,"tenderMoney")}}})],1):a("span",[e._v(e._s(t))])]}},{key:"offerWay",fn:function(t,n,i){return[1==e.pageType?a("a-form-item",[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["offerWay"+i,{validateTrigger:["blur"],rules:[{required:!0,message:"请选择报价方式"}],initialValue:t}],expression:"[\n                `offerWay${index}`,\n                {\n                  validateTrigger: ['blur'],\n                  rules: [{ required: true, message: '请选择报价方式' }],\n                  initialValue: text\n                }\n              ]"}],on:{change:function(t){return e.onCellChange(t,n.tenderFileId,"offerWay")}}},e._l(e.dictionary.cmpOfferWay,(function(t,n){return a("a-select-option",{key:n,class:{"hide-select-item":!t},attrs:{value:""+n}},[e._v(e._s(t))])})),1)],1):a("span",[e._v(e._s(e.dictionary.cmpOfferWay[t]))])]}},{key:"action",fn:function(t){return[a("a-space",{attrs:{size:8}},[a("a",[e._v("上传采购文件")]),a("a-popconfirm",{attrs:{title:"是否删除此行采购文件?","ok-text":"确认","cancel-text":"取消"},on:{confirm:function(a){return e.deleteById(t.tenderFileId)}}},[a("a",[e._v("删除采购文件")])])],1)]}}])})],1),0==this.pageType?a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.pageData.total>0,expression:"pageData.total > 0"}],attrs:{value:e.pageData.page,pageSize:e.pageData.limit,total:e.pageData.total},on:{change:e.sizeChange,showSizeChange:e.pageChange}}):e._e()],1),e.tenderFileNameVisible?a("a-modal",{attrs:{title:"批量维护项目文件",width:"80%",centered:!0,maskClosable:!1},on:{ok:function(t){return e.handleOk("tenderFileName")}},model:{value:e.tenderFileNameVisible,callback:function(t){e.tenderFileNameVisible=t},expression:"tenderFileNameVisible"}}):e._e(),e.offerWayVisible?a("a-modal",{attrs:{title:"批量维护报价方式",width:"40%",height:"200px",centered:!0,maskClosable:!1},on:{ok:function(t){return e.handleOk("offerWay")}},model:{value:e.offerWayVisible,callback:function(t){e.offerWayVisible=t},expression:"offerWayVisible"}},[a("a-select",{staticStyle:{width:"100%"},on:{change:e.offerWayChange}},e._l(e.dictionary.cmpOfferWay,(function(t,n){return a("a-select-option",{key:n,class:{"hide-select-item":!t},attrs:{value:""+n}},[e._v(e._s(t))])})),1)],1):e._e(),e.tenderMoneyVisible?a("a-modal",{attrs:{title:"批量维护标书费用",width:"40%",height:"200px",centered:!0,maskClosable:!1},on:{ok:function(t){return e.handleOk("tenderMoney")}},model:{value:e.tenderMoneyVisible,callback:function(t){e.tenderMoneyVisible=t},expression:"tenderMoneyVisible"}},[a("a-input",{staticStyle:{width:"100%"},on:{change:e.tenderMoneyChange}})],1):e._e()],1)},i=[],r=(a("99af"),a("4de4"),a("4160"),a("a434"),a("a9e3"),a("159b"),a("ade3")),s=a("2909"),o=a("5530"),l=a("5880"),c=a("8ab7"),d=a("325f"),u=a("7775"),h={limit:15,total:0,page:1,loading:!1},f=[{title:"序号",dataIndex:"number",align:"center",width:60,customRender:function(e,t,a){return"".concat((h.page-1)*h.limit+a+1)}},{title:"项目名称",dataIndex:"projectName",width:200,ellipsis:!0},{title:"项目编码",dataIndex:"projectCode",align:"center",width:150},{title:"标",dataIndex:"subtenderName",align:"center",width:100,ellipsis:!0},{title:"包",dataIndex:"subcontractingName",align:"center",width:100,ellipsis:!0},{title:"标书费用",dataIndex:"tenderMoney",scopedSlots:{customRender:"tenderMoney"},align:"center",width:200},{title:"报价方式",dataIndex:"offerWay",scopedSlots:{customRender:"offerWay"},align:"center",width:240},{title:"采购文件",dataIndex:"tenderFileName",align:"center",width:200,ellipsis:!0},{title:"操作",align:"center",scopedSlots:{customRender:"action"},width:200,fixed:"right"}],p={name:"tender-file",components:{Heading:c["default"],Pagination:d["default"]},props:{pageType:{type:[Number,String],default:1}},data:function(){return{searchForm:this.$form.createForm(this,{name:"advanced_search"}),form:this.$form.createForm(this),columns:f,dataSource:[],selectedRowKeys:[],selectedRows:[],pageData:h,isConnect:!1,show:!1,subtenderId:"",subtenderName:"",subcontractingId:"",subcontractingName:"",subtenderData:[],subcontractData:[],offerWay:"",tenderMoney:"",tenderFileNameVisible:!1,offerWayVisible:!1,tenderMoneyVisible:!1}},computed:Object(o["a"])(Object(o["a"])({},Object(l["mapGetters"])("account",["dictionary"])),{},{tenderVindicateId:function(){return this.$route.params.id}}),created:function(){this.fnInit(),this.handleGetData(),this.handleGetSubTender()},methods:{fnInit:function(){var e=Object(s["a"])(this.columns),t=this.columns.length-1;0==this.pageType&&e.splice(t,1),this.columns=Object(s["a"])(e)},onCellChange:function(e,t,a){var n=Object(s["a"])(this.dataSource),i=n.filter((function(e){return t===e.tenderFileId}))[0];i&&(i[a]=e,this.dataSource=n)},handleGetData:function(){var e=this,t=Object.assign({limit:0==this.pageType?this.pageData.limit:1e4,page:this.pageData.page,subcontractingName:this.subcontractingName||"",subtenderName:this.subtenderName||"",tenderVindicateId:this.tenderVindicateId},this.filter);this.pageData.loading=!0,this.dataSource=[],this.selectedRowKeys=[],this.selectedRows=[],Object(u["x"])(t).then((function(t){var a=t.data||{},n=a.responseResult||{};if("0000"==a.errCode){var i=n.data,r=n.total;e.dataSource=i,e.pageData.total=Number(r)}else e.$error({title:"错误提示",content:e.BASE.handleErrorMsg(a)});e.pageData.loading=!1}))},handleGetSubTender:function(){var e=this;Object(u["H"])(this.tenderVindicateId).then((function(t){var a=t.data||{},n=a.responseResult||[];"0000"==a.errCode?e.subtenderData=n:e.$error({title:"错误提示",content:e.BASE.handleErrorMsg(a)}),e.pageData.loading=!1}))},handleGetSubContract:function(){var e=this;Object(u["G"])(this.tenderVindicateId,this.subtenderId).then((function(t){var a=t.data||{},n=a.responseResult||[];"0000"==a.errCode?e.subcontractData=n:e.$error({title:"错误提示",content:e.BASE.handleErrorMsg(a)}),e.pageData.loading=!1}))},handleSubtenderNameChange:function(e){this.subtenderId=e.key,this.subtenderName=e.label,this.subcontractingName="",this.subcontractingId="",this.handleGetSubContract()},handleSubcontractChange:function(e){this.subcontractingName=e.label,this.subcontractingId=e.key},handleReset:function(){this.searchForm.resetFields(),this.subcontractingName=null,this.subtenderName="",this.subtenderId="",this.subcontractingId=""},handleShow:function(){this.show=!this.show},validTenderMoney:function(e,t,a){var n=this.BASE.reg.moneyReg;this.BASE.CheckIsNullOrEmpty(t)?n.test(t)?a():a("请输入正确的金额"):a("请输入标书费用")},handleSubmit:function(e){var t=this;e.preventDefault(e),this.form.validateFieldsAndScroll(this.BASE.formScrollOptions,(function(e){e||(t.isConnect=!0,t.updateInfo())}))},updateInfo:function(){var e=this;Object(u["X"])(this.dataSource).then((function(t){var a=t.data;"0000"===a.errCode?(e.handleGetData(),e.$message.success(a.responseResult,3)):e.$error({title:"错误提示",content:e.BASE.handleErrorMsg(a)}),e.isConnect=!1}))},handleUpdate:function(e){"offerWay"!=e&&"tenderMoney"!=e||0!=this.selectedRowKeys.length?(this["".concat(e,"Visible")]=!0,this.offerWay="",this.tenderMoney=""):this.$message.info("请先选择要设置操作的数据！")},offerWayChange:function(e){this.offerWay=e},tenderMoneyChange:function(e){this.tenderMoney=e.target.value},handleOk:function(e){var t=this;"offerWay"!=e&&"tenderMoney"!=e||this.dataSource.forEach((function(a){t.selectedRows.forEach((function(n,i){n.tenderFileId==a.tenderFileId&&(a[e]=t[e],t.form.setFieldsValue(Object(r["a"])({},"".concat(e).concat(i),t[e])))}))})),this["".concat(e,"Visible")]=!1},onSelectChange:function(e,t){this.selectedRowKeys=e,this.selectedRows=t},sizeChange:function(e,t){this.pageData.page=e,this.pageData.limit=t,this.handleGetData()},pageChange:function(e,t){this.pageData.page=e,this.pageData.limit=t,this.handleGetData()}}},g=p,m=a("2877"),b=Object(m["a"])(g,n,i,!1,null,null,null);t["default"]=b.exports},8432:function(e,t,a){"use strict";var n=a("c019"),i=a.n(n);i.a},"8ab7":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"head"},[e._m(0),a("div",{staticClass:"name"},[e._v(" "+e._s(e.name)),a("span",{staticStyle:{color:"#f5222d","font-size":"14px","font-weight":"400"}},[e._v(e._s(e.info))])]),a("span",{staticClass:"left-icon"},[e._t("leftIcon")],2),a("div",{staticClass:"button-wrapper"},[e._t("default")],2)])},i=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"head-icon"},[n("img",{attrs:{src:a("20ee"),alt:""}})])}],r={name:"heading",props:{name:{type:[String,Function],default:""},info:{type:[String,Function],default:""}}},s=r,o=(a("acc2"),a("2877")),l=Object(o["a"])(s,n,i,!1,null,"e7020ed6",null);t["default"]=l.exports},acc2:function(e,t,a){"use strict";var n=a("4b47"),i=a.n(n);i.a},c019:function(e,t,a){}}]);