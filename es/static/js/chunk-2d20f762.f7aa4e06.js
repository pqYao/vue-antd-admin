(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d20f762"],{b471:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-card",{staticClass:"notice-change-edit-wrapper"},[a("Heading",{attrs:{name:"公告变更"}},[a("a-button",{attrs:{type:"primary"},on:{click:e.fnCheckChangeRecord}},[e._v("变更记录")])],1),a("a-form",{staticClass:"es-form es-form-bk",attrs:{layout:"horizontal",form:e.form},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:(t.preventDefault(),e.fnSignAndSave(t))}}},[a("a-row",[a("a-col",{attrs:{md:16,sm:24}},[a("a-form-item",e._b({attrs:{label:"公告标题"}},"a-form-item",e.BASE.twoItemLayout,!1),[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["noticeTitle",{maxLength:50,initialValue:e.formData.noticeTitle,validateTrigger:["blur"],rules:[{required:!0,message:"请输入标题"}]}],expression:"[\n              `noticeTitle`,\n              {\n                maxLength: 50,\n                initialValue: formData.noticeTitle,\n                validateTrigger: ['blur'],\n                rules: [{ required: true, message: '请输入标题' }]\n              }\n            ]"}],attrs:{disabled:"",placeholder:"请输入",allowClear:""}})],1)],1)],1),a("a-row",[a("a-col",{attrs:{md:8,sm:24}},[a("a-form-item",e._b({attrs:{label:"标书售卖开始时间"}},"a-form-item",e.BASE.oneItemLayout,!1),[a("a-date-picker",{directives:[{name:"decorator",rawName:"v-decorator",value:["bidSaletimeStart",{rules:[{required:!0,message:"请选择标书售卖开始时间"}],initialValue:e.formData.bidSaletimeStart}],expression:"[\n              'bidSaletimeStart',\n              {\n                rules: [\n                  { required: true, message: '请选择标书售卖开始时间' }\n                ],\n                initialValue: formData.bidSaletimeStart\n              }\n            ]"}],staticStyle:{width:"100%"},attrs:{showTime:"",disabled:"",format:"YYYY-MM-DD  HH:mm:ss"}})],1)],1),a("a-col",{attrs:{md:8,sm:24}},[a("a-form-item",e._b({attrs:{label:"标书售卖截止时间"}},"a-form-item",e.BASE.oneItemLayout,!1),[a("a-date-picker",{directives:[{name:"decorator",rawName:"v-decorator",value:["bidSaletimeEnd",{rules:[{required:!0,message:"请选择标书售卖截止时间"}],initialValue:e.formData.bidSaletimeEnd}],expression:"[\n              'bidSaletimeEnd',\n              {\n                rules: [\n                  { required: true, message: '请选择标书售卖截止时间' }\n                ],\n                initialValue: formData.bidSaletimeEnd\n              }\n            ]"}],staticStyle:{width:"100%"},attrs:{showTime:"",disabledDate:e.disabledBidSaletimeEnd,format:"YYYY-MM-DD  HH:mm:ss"},on:{change:e.bidSaletimeEndChange}})],1)],1),a("a-col",{attrs:{md:8,sm:24}},[a("a-form-item",e._b({attrs:{label:"投标截止时间"}},"a-form-item",e.BASE.oneItemLayout,!1),[a("a-date-picker",{directives:[{name:"decorator",rawName:"v-decorator",value:["tenderOffTime",{rules:[{required:!0,message:"请选择投标截止时间"}],initialValue:e.formData.tenderOffTime}],expression:"[\n              'tenderOffTime',\n              {\n                rules: [{ required: true, message: '请选择投标截止时间' }],\n                initialValue: formData.tenderOffTime\n              }\n            ]"}],staticStyle:{width:"100%"},attrs:{showTime:"",disabledDate:e.disabledTenderOffTime,format:"YYYY-MM-DD  HH:mm:ss"},on:{change:e.tenderOffTimeChange}})],1)],1)],1),a("a-row",[a("a-col",{attrs:{md:24,sm:24}},[a("a-form-item",e._b({attrs:{label:"内容"}},"a-form-item",e.BASE.threeItemLayout,!1),[e.tinymceRefresh?a("tinymce",{attrs:{height:300},model:{value:e.formData.noticeContent,callback:function(t){e.$set(e.formData,"noticeContent",t)},expression:"formData.noticeContent"}}):e._e()],1)],1)],1)],1),a("audit-button",[a("a-button",{attrs:{type:"primary"},on:{click:e.fnView}},[e._v(" 预览 ")]),a("a-button",{attrs:{type:"primary"},on:{click:e.fnSignAndSave}},[e._v(" 保存 ")]),a("a-button",{attrs:{type:"primary"},on:{click:e.fnSubmitChange}},[e._v(" 提交审批 ")]),a("a-button",{attrs:{type:"primary"},on:{click:e.fnSubmitChange}},[e._v(" 确认变更 ")])],1),e.changeRecordVisible?a("a-modal",{attrs:{title:"变更记录",width:"80%",footer:null,centered:!0,maskClosable:!1},model:{value:e.changeRecordVisible,callback:function(t){e.changeRecordVisible=t},expression:"changeRecordVisible"}},[a("notice-change-record",{ref:"linkman",on:{"close-modal":e.fnCloseModal}})],1):e._e()],1)},i=[],r=(a("c975"),a("d3b7"),a("c1df")),o=a.n(r),s=a("5cb8"),c={name:"notice-change-edit",components:{Tinymce:function(){return a.e("chunk-4f37c6f9").then(a.bind(null,"8256"))},Heading:function(){return a.e("chunk-e2119ce0").then(a.bind(null,"8ab7"))},AuditButton:function(){return a.e("chunk-e290473a").then(a.bind(null,"66e3"))},NoticeChangeRecord:function(){return Promise.all([a.e("chunk-2d0ba2cb"),a.e("chunk-02c0b570")]).then(a.bind(null,"556e"))}},data:function(){return{form:this.$form.createForm(this),formData:{},changeRecordVisible:!1,tinymceRefresh:!1}},created:function(){this.fnGetDetailInfo()},activated:function(){this.fnGetDetailInfo()},computed:{projectId:function(){return this.$route.params.id},noticeChangeId:function(){return this.$route.query.ncid}},methods:{moment:o.a,fnGetDetailInfo:function(){var e=this,t={projectId:this.projectId,noticeChangeId:this.noticeChangeId};Object(s["J"])(t).then((function(t){var a=t.data;"0000"==a.errCode?(e.formData=a.responseResult||{},e.tinymceRefresh=!1,e.$nextTick((function(){e.tinymceRefresh=!0}))):e.$error({content:e.BASE.handleErrorMsg(a)})}))},fnSignAndSave:function(){var e=this;this.form.validateFieldsAndScroll(this.BASE.formScrollOptions,(function(t,a){if(!t){for(var n in a)-1==n.indexOf("time")&&-1==n.indexOf("Time")&&(e.formData[n]=a[n]);e.formData.projectId=e.projectId,Object(s["Q"])(e.formData).then((function(t){var a=t.data;"0000"==a.errCode?(e.fnGetDetailInfo(),e.noticeChangeId||e.$router.push({query:{ncid:a.responseResult}}),e.$message.success("操作成功！",3)):e.$error({content:e.BASE.handleErrorMsg(a)})}))}}))},fnSubmitChange:function(){var e=this;Object(s["S"])(this.formData.noticeChangeId).then((function(t){var a=t.data;"0000"==a.errCode?(e.$message.success(a.responseResult,3),e.$router.push({path:"/other/tender/notice-change"})):e.$error({content:e.BASE.handleErrorMsg(a)})}))},fnView:function(){this.formData.noticeContext=this.formData.noticeContent,this.$router.push({path:"/notice-preview/".concat(this.formData.projectId),query:{formData:JSON.stringify(this.formData)}})},tenderOffTimeChange:function(e,t){this.formData.tenderOffTime=t,this.$set(this.formData,"tenderOffTime",t)},bidSaletimeEndChange:function(e,t){this.formData.bidSaletimeEnd=t,this.$set(this.formData,"bidSaletimeEnd",t)},disabledBidSaletimeEnd:function(e){return e&&e<o()(this.formData.bidingDocSaleStart).endOf("String")},disabledTenderOffTime:function(e){return e&&e<o()(this.formData.bidSaletimeEnd).endOf("String")},fnCheckChangeRecord:function(){this.changeRecordVisible=!0},fnCloseModal:function(){this.changeRecordVisible=!1}}},d=c,m=a("2877"),l=Object(m["a"])(d,n,i,!1,null,null,null);t["default"]=l.exports}}]);